'use strict';

var itemQuantity = document.getElementsByClassName('item-quantity');
var itemPrice = document.getElementsByClassName('item-price');
var minus = document.getElementsByClassName('icon-minus');
var plus = document.getElementsByClassName('icon-plus');
var quantity = document.getElementsByClassName('quantity');
var priceToSum = document.getElementsByClassName('price');
var priceTotal = document.getElementById('total');
var taxPrice = document.getElementById('moms');
var deliver = document.getElementById('deliver');
var store = document.getElementById('store');

console.log(deliver.parentElement.nextElementSibling);

var itemPriceCalc = function () {
  var newQuantity = void 0;
  var newItemPrice = void 0;

  var getItemPrice = function getItemPrice(index) {
    var price = index === 0 ? 599 : 139;
    parseInt(price);
    return price;
  };

  var getTotalPrice = function getTotalPrice() {
    var priceArray = Array.from(priceToSum);
    var numberArray = priceArray.map(function (item) {
      return parseInt(item.textContent);
    });
    var sum = numberArray.reduce(function (total, num) {
      return total + num;
    });
    var extraCost = deliver.checked ? 79 : 0;
    var totalPrice = deliver.checked ? sum + extraCost : sum;
    return totalPrice;
  };

  var getTax = function getTax() {
    var total = parseInt(priceTotal.textContent);
    var tax = parseInt(total * 0.25);
    return tax;
  };

  var changeItemPrice = function changeItemPrice(index, q, action) {
    var currentItemPrice = parseInt(itemPrice[index].textContent);
    var priceOfItem = getItemPrice(index);
    newItemPrice = action ? currentItemPrice + priceOfItem : currentItemPrice - priceOfItem;
    itemPrice[index].innerHTML = newItemPrice;
    priceTotal.innerHTML = getTotalPrice();
    taxPrice.innerHTML = getTax();
  };

  var subtract = function subtract(index) {
    var currentQuantity = parseInt(quantity[index].textContent);
    if (currentQuantity > 0) {
      newQuantity = currentQuantity - 1;
      quantity[index].innerHTML = newQuantity;
      changeItemPrice(index, newQuantity, 0);
    } else if (itemQuantity === 0) {
      return;
    }
  };

  var add = function add(index) {
    var currentQuantity = parseInt(quantity[index].textContent);
    newQuantity = currentQuantity + 1;
    quantity[index].innerHTML = newQuantity;
    changeItemPrice(index, newQuantity, 1);
  };

  var changeDeliverStatus = function changeDeliverStatus() {
    priceTotal.innerHTML = getTotalPrice();
  };

  return {
    sub: subtract,
    add: add,
    delivery: changeDeliverStatus,
    total: getTotalPrice,
    tax: getTax
  };
}();

minus[0].addEventListener('click', function () {
  return itemPriceCalc.sub(0);
}, false);
plus[0].addEventListener('click', function () {
  return itemPriceCalc.add(0);
}, false);

minus[1].addEventListener('click', function () {
  return itemPriceCalc.sub(1);
}, false);
plus[1].addEventListener('click', function () {
  return itemPriceCalc.add(1);
}, false);

deliver.addEventListener('click', itemPriceCalc.delivery, false);
store.addEventListener('click', itemPriceCalc.delivery, false);

priceTotal.innerHTML = itemPriceCalc.total();
taxPrice.innerHTML = itemPriceCalc.tax();
'use strict';

var tabletControl = function () {
  var personalNumber = [];
  var firstContainer = document.getElementById('first-digits');
  var secondContainer = document.getElementById('last-digits');

  var getValue = function getValue(event) {
    var selectedNumber = event.target.tagName === 'P' && event.target.className !== 'check' && event.target.className !== 'delete' && event.target.textContent;
    if (selectedNumber) {
      if (personalNumber.length < 10) {
        personalNumber.push(selectedNumber);
        setValue(personalNumber);
      } else {
        console.log('reached max');
      }
    } else if (event.target.id === 'check') {
      console.log('clicked ok');
    } else if (event.target.id === 'delete') {
      personalNumber.pop();
      setValue(personalNumber);
    }
  };

  var setValue = function setValue(array) {
    firstContainer.innerHTML = array.slice(0, 6).join('');
    secondContainer.innerHTML = array.slice(6).join('');
  };

  return {
    getValue: getValue
  };
}();

var tablet = document.getElementById('tablet-wrapper');
tablet.addEventListener('click', tabletControl.getValue, false);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIml0ZW1QcmljZS5qcyIsInRhYmxldENvbnRyb2wuanMiXSwibmFtZXMiOlsiaXRlbVF1YW50aXR5IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiaXRlbVByaWNlIiwibWludXMiLCJwbHVzIiwicXVhbnRpdHkiLCJwcmljZVRvU3VtIiwicHJpY2VUb3RhbCIsImdldEVsZW1lbnRCeUlkIiwidGF4UHJpY2UiLCJkZWxpdmVyIiwic3RvcmUiLCJjb25zb2xlIiwibG9nIiwicGFyZW50RWxlbWVudCIsIm5leHRFbGVtZW50U2libGluZyIsIml0ZW1QcmljZUNhbGMiLCJuZXdRdWFudGl0eSIsIm5ld0l0ZW1QcmljZSIsImdldEl0ZW1QcmljZSIsInByaWNlIiwiaW5kZXgiLCJwYXJzZUludCIsImdldFRvdGFsUHJpY2UiLCJwcmljZUFycmF5IiwiQXJyYXkiLCJmcm9tIiwibnVtYmVyQXJyYXkiLCJtYXAiLCJpdGVtIiwidGV4dENvbnRlbnQiLCJzdW0iLCJyZWR1Y2UiLCJ0b3RhbCIsIm51bSIsImV4dHJhQ29zdCIsImNoZWNrZWQiLCJ0b3RhbFByaWNlIiwiZ2V0VGF4IiwidGF4IiwiY2hhbmdlSXRlbVByaWNlIiwicSIsImFjdGlvbiIsImN1cnJlbnRJdGVtUHJpY2UiLCJwcmljZU9mSXRlbSIsImlubmVySFRNTCIsInN1YnRyYWN0IiwiY3VycmVudFF1YW50aXR5IiwiYWRkIiwiY2hhbmdlRGVsaXZlclN0YXR1cyIsInN1YiIsImRlbGl2ZXJ5IiwiYWRkRXZlbnRMaXN0ZW5lciIsInRhYmxldENvbnRyb2wiLCJwZXJzb25hbE51bWJlciIsImZpcnN0Q29udGFpbmVyIiwic2Vjb25kQ29udGFpbmVyIiwiZ2V0VmFsdWUiLCJldmVudCIsInNlbGVjdGVkTnVtYmVyIiwidGFyZ2V0IiwidGFnTmFtZSIsImNsYXNzTmFtZSIsImxlbmd0aCIsInB1c2giLCJzZXRWYWx1ZSIsImlkIiwicG9wIiwiYXJyYXkiLCJzbGljZSIsImpvaW4iLCJ0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RUFBOEI7QUFDbkN0RCxjQUFRQyxHQUFSLENBQVksWUFBWjtBQUNELEtBRk0sTUFFQSxJQUFHNkMsTUFBTUUsTUFBTixDQUFhTSxFQUFiLEtBQW9CLFFBQXZCLEVBQWdDO0FBQ3JDWixxQkFBZWEsR0FBZjtBQUNBRixlQUFTWCxjQUFUO0FBQ0Q7QUFDRixHQWZEOztBQWlCQSxNQUFNVyxXQUFTLFNBQVRBLFFBQVMsQ0FBQ0csS0FBRCxFQUFTO0FBQ3RCYixtQkFBZVYsU0FBZixHQUEyQnVCLE1BQU1DLEtBQU4sQ0FBWSxDQUFaLEVBQWMsQ0FBZCxFQUFpQkMsSUFBakIsQ0FBc0IsRUFBdEIsQ0FBM0I7QUFDQWQsb0JBQWdCWCxTQUFoQixHQUE0QnVCLE1BQU1DLEtBQU4sQ0FBWSxDQUFaLEVBQWVDLElBQWYsQ0FBb0IsRUFBcEIsQ0FBNUI7QUFDRCxHQUhEOztBQUtBLFNBQU87QUFDTGIsY0FBVUE7QUFETCxHQUFQO0FBSUQsQ0EvQnFCLEVBQXRCOztBQWlDQSxJQUFNYyxTQUFTdkUsU0FBU1EsY0FBVCxDQUF3QixnQkFBeEIsQ0FBZjtBQUNBK0QsT0FBT25CLGdCQUFQLENBQXdCLE9BQXhCLEVBQWlDQyxjQUFjSSxRQUEvQyxFQUF5RCxLQUF6RCIsImZpbGUiOiJjb25jYXQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBpdGVtUXVhbnRpdHkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdpdGVtLXF1YW50aXR5Jyk7XG5jb25zdCBpdGVtUHJpY2UgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdpdGVtLXByaWNlJyk7XG5jb25zdCBtaW51cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2ljb24tbWludXMnKTtcbmNvbnN0IHBsdXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdpY29uLXBsdXMnKTtcbmNvbnN0IHF1YW50aXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncXVhbnRpdHknKTtcbmNvbnN0IHByaWNlVG9TdW0gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwcmljZScpO1xuY29uc3QgcHJpY2VUb3RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b3RhbCcpO1xuY29uc3QgdGF4UHJpY2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9tcycpO1xuY29uc3QgZGVsaXZlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWxpdmVyJyk7XG5jb25zdCBzdG9yZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9yZScpO1xuXG5jb25zb2xlLmxvZyhkZWxpdmVyLnBhcmVudEVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nKVxuXG5jb25zdCBpdGVtUHJpY2VDYWxjID0gKCgpPT57XG4gIGxldCBuZXdRdWFudGl0eTtcbiAgbGV0IG5ld0l0ZW1QcmljZTtcblxuICBjb25zdCBnZXRJdGVtUHJpY2UgPSBpbmRleCA9PntcbiAgICBjb25zdCBwcmljZSA9ICggaW5kZXggPT09IDAgKSA/IDU5OSA6IDEzOTtcbiAgICBwYXJzZUludChwcmljZSk7XG4gICAgcmV0dXJuIHByaWNlO1xuICB9XG5cbiAgY29uc3QgZ2V0VG90YWxQcmljZSA9ICgpPT57XG4gICAgY29uc3QgcHJpY2VBcnJheSA9IEFycmF5LmZyb20ocHJpY2VUb1N1bSk7XG4gICAgY29uc3QgbnVtYmVyQXJyYXkgPSBwcmljZUFycmF5Lm1hcChpdGVtPT5wYXJzZUludChpdGVtLnRleHRDb250ZW50KSlcbiAgICBsZXQgc3VtID0gbnVtYmVyQXJyYXkucmVkdWNlKCh0b3RhbCwgbnVtKT0+IHRvdGFsK251bSk7XG4gICAgY29uc3QgZXh0cmFDb3N0ID0gZGVsaXZlci5jaGVja2VkID8gNzkgOiAwO1xuICAgIGxldCB0b3RhbFByaWNlID0gZGVsaXZlci5jaGVja2VkID8gc3VtICsgZXh0cmFDb3N0IDogc3VtO1xuICAgIHJldHVybiB0b3RhbFByaWNlO1xuICB9XG5cbiAgY29uc3QgZ2V0VGF4ID0gKCkgPT4ge1xuICAgIGNvbnN0IHRvdGFsID0gcGFyc2VJbnQocHJpY2VUb3RhbC50ZXh0Q29udGVudCk7XG4gICAgY29uc3QgdGF4ID0gcGFyc2VJbnQodG90YWwgKiAwLjI1KTtcbiAgICByZXR1cm4gdGF4O1xuICB9XG5cbiAgY29uc3QgY2hhbmdlSXRlbVByaWNlID0gKGluZGV4LCBxLCBhY3Rpb24pID0+e1xuICAgIGxldCBjdXJyZW50SXRlbVByaWNlID0gcGFyc2VJbnQoaXRlbVByaWNlW2luZGV4XS50ZXh0Q29udGVudCk7XG4gICAgbGV0IHByaWNlT2ZJdGVtID0gZ2V0SXRlbVByaWNlKGluZGV4KTtcbiAgICBuZXdJdGVtUHJpY2UgPSBhY3Rpb24gPyBjdXJyZW50SXRlbVByaWNlICsgcHJpY2VPZkl0ZW0gOiBjdXJyZW50SXRlbVByaWNlIC0gcHJpY2VPZkl0ZW07XG4gICAgaXRlbVByaWNlW2luZGV4XS5pbm5lckhUTUwgPSBuZXdJdGVtUHJpY2U7XG4gICAgcHJpY2VUb3RhbC5pbm5lckhUTUwgPSBnZXRUb3RhbFByaWNlKCk7XG4gICAgdGF4UHJpY2UuaW5uZXJIVE1MID0gZ2V0VGF4KCk7XG4gIH1cblxuICBjb25zdCBzdWJ0cmFjdCA9IGluZGV4ID0+IHtcbiAgICBsZXQgY3VycmVudFF1YW50aXR5ID0gcGFyc2VJbnQocXVhbnRpdHlbaW5kZXhdLnRleHRDb250ZW50KTtcbiAgICBpZihjdXJyZW50UXVhbnRpdHkgPiAwKXtcbiAgICAgIG5ld1F1YW50aXR5ID0gY3VycmVudFF1YW50aXR5LTE7XG4gICAgICBxdWFudGl0eVtpbmRleF0uaW5uZXJIVE1MID0gbmV3UXVhbnRpdHk7XG4gICAgICBjaGFuZ2VJdGVtUHJpY2UoaW5kZXgsIG5ld1F1YW50aXR5LCAwKTtcbiAgICB9IGVsc2UgaWYgKGl0ZW1RdWFudGl0eSA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGFkZCA9IGluZGV4ID0+e1xuICAgIGxldCBjdXJyZW50UXVhbnRpdHkgPSBwYXJzZUludChxdWFudGl0eVtpbmRleF0udGV4dENvbnRlbnQpO1xuICAgIG5ld1F1YW50aXR5ID0gY3VycmVudFF1YW50aXR5KzE7XG4gICAgcXVhbnRpdHlbaW5kZXhdLmlubmVySFRNTCA9IG5ld1F1YW50aXR5O1xuICAgIGNoYW5nZUl0ZW1QcmljZShpbmRleCwgbmV3UXVhbnRpdHksIDEpO1xuICB9XG5cbiAgY29uc3QgY2hhbmdlRGVsaXZlclN0YXR1cyA9ICgpPT57XG4gICAgcHJpY2VUb3RhbC5pbm5lckhUTUwgPSBnZXRUb3RhbFByaWNlKCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHN1Yjogc3VidHJhY3QsXG4gICAgYWRkOiBhZGQsXG4gICAgZGVsaXZlcnk6IGNoYW5nZURlbGl2ZXJTdGF0dXMsXG4gICAgdG90YWw6IGdldFRvdGFsUHJpY2UsXG4gICAgdGF4OiBnZXRUYXhcbiAgfVxuICAgIFxufSkoKTtcblxubWludXNbMF0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+aXRlbVByaWNlQ2FsYy5zdWIoMCksIGZhbHNlKTtcbnBsdXNbMF0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+aXRlbVByaWNlQ2FsYy5hZGQoMCksIGZhbHNlKTtcblxubWludXNbMV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+aXRlbVByaWNlQ2FsYy5zdWIoMSksIGZhbHNlKTtcbnBsdXNbMV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+aXRlbVByaWNlQ2FsYy5hZGQoMSksIGZhbHNlKTtcblxuZGVsaXZlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGl0ZW1QcmljZUNhbGMuZGVsaXZlcnksIGZhbHNlKTtcbnN0b3JlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaXRlbVByaWNlQ2FsYy5kZWxpdmVyeSwgZmFsc2UpO1xuXG5wcmljZVRvdGFsLmlubmVySFRNTCA9IGl0ZW1QcmljZUNhbGMudG90YWwoKTtcbnRheFByaWNlLmlubmVySFRNTCA9IGl0ZW1QcmljZUNhbGMudGF4KCk7IiwiY29uc3QgdGFibGV0Q29udHJvbCA9ICgoKT0+e1xuICBsZXQgcGVyc29uYWxOdW1iZXIgPSBbXTtcbiAgY29uc3QgZmlyc3RDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlyc3QtZGlnaXRzJyk7XG4gIGNvbnN0IHNlY29uZENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsYXN0LWRpZ2l0cycpO1xuXG4gIGNvbnN0IGdldFZhbHVlPShldmVudCk9PntcbiAgICBsZXQgc2VsZWN0ZWROdW1iZXIgPSAoZXZlbnQudGFyZ2V0LnRhZ05hbWUgPT09ICdQJyAmJiBldmVudC50YXJnZXQuY2xhc3NOYW1lICE9PSAnY2hlY2snICYmIGV2ZW50LnRhcmdldC5jbGFzc05hbWUgIT09ICdkZWxldGUnKSAmJiBldmVudC50YXJnZXQudGV4dENvbnRlbnQ7XG4gICAgaWYoc2VsZWN0ZWROdW1iZXIpe1xuICAgICAgaWYocGVyc29uYWxOdW1iZXIubGVuZ3RoIDwgMTApe1xuICAgICAgICBwZXJzb25hbE51bWJlci5wdXNoKHNlbGVjdGVkTnVtYmVyKTtcbiAgICAgICAgc2V0VmFsdWUocGVyc29uYWxOdW1iZXIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3JlYWNoZWQgbWF4Jyk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmKGV2ZW50LnRhcmdldC5pZCA9PT0nY2hlY2snKXtcbiAgICAgIGNvbnNvbGUubG9nKCdjbGlja2VkIG9rJylcbiAgICB9IGVsc2UgaWYoZXZlbnQudGFyZ2V0LmlkID09PSAnZGVsZXRlJyl7XG4gICAgICBwZXJzb25hbE51bWJlci5wb3AoKTtcbiAgICAgIHNldFZhbHVlKHBlcnNvbmFsTnVtYmVyKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBzZXRWYWx1ZT0oYXJyYXkpPT57XG4gICAgZmlyc3RDb250YWluZXIuaW5uZXJIVE1MID0gYXJyYXkuc2xpY2UoMCw2KS5qb2luKCcnKTtcbiAgICBzZWNvbmRDb250YWluZXIuaW5uZXJIVE1MID0gYXJyYXkuc2xpY2UoNikuam9pbignJyk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGdldFZhbHVlOiBnZXRWYWx1ZVxuICB9XG5cbn0pKCk7XG5cbmNvbnN0IHRhYmxldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YWJsZXQtd3JhcHBlcicpO1xudGFibGV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGFibGV0Q29udHJvbC5nZXRWYWx1ZSwgZmFsc2UpO1xuIl19
